

## 什么是 extern 关键字？

`extern` 是一个 C++ 关键字，用于声明一个变量或函数在其他文件中定义。它告诉编译器，这个变量或函数在当前文件中只是一个声明，它的定义在其他地方。

### extern 关键字的用处

`extern` 关键字主要有以下几个方面的用途：

1. **声明外部变量**
    
    - 当需要在多个源文件中共享同一个全局变量时，可以使用 `extern` 关键字在其他文件中声明这个变量。
    - 这样，编译器就不会在当前文件中为这个变量分配内存空间，而是会去其他文件中寻找它的定义。
    
    
    
    ```C++
    // file1.cpp
    int globalVar = 10; // 定义全局变量
    
    // file2.cpp
    extern int globalVar; // 声明外部变量
    
    void myFunction() {
      globalVar = 20; // 修改 file1.cpp 中定义的 globalVar
    }
    ```
    
2. **声明外部函数**
    
    - 当需要在当前文件中调用在其他文件中定义的函数时，可以使用 `extern` 关键字声明这个函数。
    - 这样，编译器就知道这个函数的定义在其他地方，链接器会将函数的调用链接到正确的函数定义。
    
    C++
    
    ```c++
    // file1.cpp
    void myFunc() {
      // 函数实现
    }
    
    // file2.cpp
    extern void myFunc(); // 声明外部函数
    
    int main() {
      myFunc(); // 调用 file1.cpp 中定义的 myFunc 函数
      return 0;
    }
    ```
    
3. **与 "C" 链接**
    
    - 当需要在 C++ 代码中调用 C 代码中的函数或变量时，可以使用 `extern "C"` 声明这些函数或变量。
    - 这是因为 C++ 编译器会对函数名进行名称修饰（name mangling），而 C 编译器不会。使用 `extern "C"` 可以告诉 C++ 编译器不要对这些函数名进行修饰，以便链接器能够找到正确的函数定义。
    
  
    
    ```  C++
    // file1.c
    int cFunc() {
      return 10;
    }
    
    // file2.cpp
    extern "C" int cFunc(); // 声明 C 函数
    
    int main() {
      int result = cFunc(); // 调用 C 函数
      return 0;
    }
    ```
    

### 使用 extern 关键字的注意事项

- `extern` 关键字只是声明，不分配内存空间。变量的定义必须在其他文件中。
- 在头文件中声明外部变量和函数时，通常使用 `extern` 关键字。
- 避免在头文件中定义全局变量，以免引起链接错误。

### 总结

`extern` 关键字是 C++ 中一个重要的关键字，它允许在多个源文件中共享变量和函数，实现代码的模块化和重用。合理使用 `extern` 关键字可以提高代码的可维护性和可扩展性。